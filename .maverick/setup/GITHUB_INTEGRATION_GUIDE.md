# üêô GitHub Integration Setup Guide

## üéØ Why GitHub Integration?

GitHub integration enables Maverick to:
- **Create repositories** for generated business apps
- **Deploy code** automatically to GitHub
- **Set up CI/CD pipelines** for continuous deployment
- **Manage webhooks** for deployment notifications
- **Version control** all generated business applications
- **Enable collaboration** for business teams

## üîß What I've Added:

### **‚úÖ GitHub OAuth Provider**
- Added GitHub provider to NextAuth configuration
- Configured required scopes: `repo`, `user:email`, `admin:repo_hook`
- Added GitHub connection tracking in database

### **‚úÖ Database Schema**
- `github_connections` table for storing GitHub tokens
- User relationship with GitHub account data
- Scope tracking for permission management

### **‚úÖ GitHub API Service**
- Complete `GitHubService` class for API interactions
- Repository creation and management
- File upload and batch operations
- Webhook setup for deployment notifications
- Scope validation and error handling

### **‚úÖ Login/Register Integration**
- Added "Continue with GitHub" buttons
- Matching UI design with Square integration
- Proper OAuth flow handling

## üöÄ Setup Instructions:

### **1. Create GitHub OAuth App**

1. **Go to GitHub Developer Settings:**
   - Visit: https://github.com/settings/developers
   - Click "New OAuth App"

2. **Configure OAuth App:**
   ```
   Application name: Maverick Business Formation
   Homepage URL: http://localhost:3000
   Authorization callback URL: http://localhost:3000/api/auth/callback/github
   ```

3. **Get Credentials:**
   - Copy your **Client ID**
   - Generate and copy your **Client Secret**

### **2. Update Environment Variables**

Add to your `.env.local`:
```env
# GitHub OAuth Configuration
GITHUB_CLIENT_ID=your_github_client_id_here
GITHUB_CLIENT_SECRET=your_github_client_secret_here
```

### **3. Update Database Schema**

The SQL script (`database-setup.sql`) now includes:
```sql
-- GitHub connections table
CREATE TABLE "github_connections" (
  "id" TEXT PRIMARY KEY,
  "userId" TEXT UNIQUE NOT NULL,
  "githubId" TEXT UNIQUE NOT NULL,
  "username" TEXT UNIQUE NOT NULL,
  "accessToken" TEXT NOT NULL,
  "scopes" TEXT[],
  -- ... timestamps and relations
);
```

## üîÑ How It Works:

### **Authentication Flow:**
1. User clicks "Continue with GitHub"
2. Redirected to GitHub OAuth
3. User grants permissions (repo, user:email, admin:repo_hook)
4. GitHub returns authorization code
5. NextAuth exchanges for access token
6. Token stored in `github_connections` table
7. User can now create repositories via Maverick

### **Repository Creation:**
```typescript
// When generating a business app
const github = await getGitHubServiceForUser(userId)
const repo = await github.createRepository({
  name: 'my-coffee-shop',
  description: 'Coffee shop app generated by Maverick',
  private: false,
  auto_init: true
})

// Upload generated app files
await github.uploadMultipleFiles(repo.full_name, [
  { path: 'src/app/page.tsx', content: generatedAppCode },
  { path: 'package.json', content: packageJson },
  // ... more files
])
```

## üé® Features Enabled:

### **üèóÔ∏è App Generation to GitHub:**
```typescript
// Create business repository with generated app
const result = await createBusinessRepository(
  userId, 
  'My Coffee Shop', 
  'ecommerce'
)
// Returns: { repository, url, cloneUrl }
```

### **üìÅ File Management:**
- Upload single files or batch uploads
- Proper base64 encoding for binary files
- Automatic commit messages
- Error handling for conflicts

### **üîó Webhook Integration:**
```typescript
// Set up deployment webhooks
await github.createWebhook(
  repoName, 
  'https://your-deployment-service.com/webhook'
)
```

### **üîê Permission Validation:**
```typescript
// Check if user has required scopes
const { hasRequiredScopes, missing } = await github.checkScopes()
if (!hasRequiredScopes) {
  // Request additional permissions
}
```

## üéØ Business App Generation Flow:

### **1. User Completes Chat Wizard**
- Business details captured
- App type selected (e-commerce, booking, etc.)

### **2. GitHub Repository Created**
```typescript
const repo = await createBusinessRepository(
  session.user.id,
  wizardData.businessName,
  wizardData.appType
)
```

### **3. Generated Code Uploaded**
```typescript
const appFiles = await generateBusinessApp(wizardData)
await github.uploadMultipleFiles(repo.full_name, appFiles, 'Initial app generation')
```

### **4. Deployment Configured**
```typescript
// Set up Vercel/Netlify webhook
await github.createWebhook(repo.full_name, deploymentWebhookUrl)
```

## üîß Available API Operations:

### **Repository Management:**
- `createRepository()` - Create new repo
- `listRepositories()` - Get user's repos
- `uploadFile()` - Upload single file
- `uploadMultipleFiles()` - Batch upload

### **User Information:**
- `getProfile()` - Get GitHub profile
- `checkScopes()` - Validate permissions

### **Webhooks:**
- `createWebhook()` - Set up deployment hooks

## üõ°Ô∏è Security & Permissions:

### **Required Scopes:**
- `repo` - Create and manage repositories
- `user:email` - Access user email for account linking
- `admin:repo_hook` - Manage webhooks for deployment

### **Token Security:**
- Tokens stored encrypted in database
- Automatic token refresh (when available)
- Scope validation on each API call

### **Privacy:**
- Repositories created as public by default
- Can be configured for private repos
- User has full control over their repositories

## üöÄ Production Deployment:

### **For Production:**
1. Update GitHub OAuth app with production URL
2. Set production callback URL: `https://yourdomain.com/api/auth/callback/github`
3. Update environment variables with production values

### **Rate Limiting:**
- GitHub API: 5000 requests/hour for authenticated users
- Batch operations to minimize API calls
- Proper error handling for rate limits

## üéâ Benefits:

### **For Users:**
- **One-click deployment** - App goes from chat to GitHub to live site
- **Version control** - Full Git history of their business app
- **Collaboration** - Can invite team members to repository
- **Customization** - Can modify generated code as needed

### **For Maverick:**
- **Professional delivery** - Apps delivered via industry-standard platform
- **Scalability** - GitHub handles all code hosting and version control
- **Integration** - Easy setup with deployment services (Vercel, Netlify, etc.)
- **Transparency** - Users can see exactly what code was generated

This integration transforms Maverick from a business formation tool into a complete **business + technology platform**! üöÄ